<?xml version="1.0"?>
<project name="myproject" default="info" basedir=".">
	<property file="build.properties" />
	<property name="src.dir" value="${basedir}/../../../src/main/java" />
	<target name="info">
		<echo>Hello World - Welcome to Apache Ant!</echo>
	</target>
	<path id="master-classpath">
		<fileset dir="/Users/lyt1987/Desktop/study/01_maven/repo/org/apache/ant/">
			<include name="*/*.jar" />
		</fileset>
		<pathelement path="${build.dir}" />
	</path>
	<target name="compile" description="Compile main 
      source tree java files">
		<mkdir dir="${build.dir}" />
		<javac destdir="${build.dir}" source="1.5" target="1.5" debug="true"
			deprecation="false" optimize="false" failonerror="true">
			<src path="${src.dir}" />
		</javac>
	</target>
	<target name="build-jar" depends="compile">
		<jar destfile="${web.dir}/lib/util.jar" basedir="${build.dir}/classes"
			includes="faxapp/util/**" excludes="**/Test.class">
			<manifest>
				<attribute name="Main-Class" value="com.yiibai.util.FaxUtil" />
			</manifest>
		</jar>
	</target>
	<target name="build-war">
		<war destfile="fax.war" webxml="${web.dir}/web.xml">
			<fileset dir="${web.dir}/WebContent">
				<include name="**/*.*" />
			</fileset>
			<lib dir="thirdpartyjars">
				<exclude name="portlet.jar" />
			</lib>
			<classes dir="${build.dir}/web" />
		</war>
	</target>
	<target name="generate-javadoc">
		<javadoc packagenames="faxapp.*" sourcepath="${src.dir}"
			destdir="doc" version="true" windowtitle="Fax Application">
			<doctitle><![CDATA[= Fax Application =]]></doctitle>
			<bottom>
	         <![CDATA[Copyright Â© 2011. All Rights Reserved.]]>
			</bottom>
			<group title="util packages" packages="faxapp.util.*" />
			<group title="web packages" packages="faxapp.web.*" />
			<group title="data packages" packages="faxapp.entity.*:faxapp.dao.*" />
		</javadoc>
		<echo message="java doc has been generated!" />
	</target>

	<target name="deploy" depends="compile" description="Deploy application">
		<copy todir="${deploy.path}/${name}" preservelastmodified="true">
			<fileset dir="${web.dir}">
				<include name="**/*.*" />
			</fileset>
		</copy>
	</target>

	<target name="upload-ftp" description="Upload build to an FTP server">
		<!-- Upload everything under the destination.dir to the FTP server. -->
		<ftp server="${ftp.hostname}" remotedir="/" userid="${ftp.username}"
			password="${ftp.userpassword}" separator="\" verbose="yes" binary="yes">
			<fileset dir="${destination.dir}">
				<include name="**/*.*" />
			</fileset>
		</ftp>
	</target>
	<target name="send-mail" description="Notify testing team of the new build">
		<!-- Read build information from the build.info file. -->
		<property file="${destination.dir}/build.info" />
		<!-- Send a mail to the testing team. -->
		<mail mailhost="${smtp.hostname}" mailport="${smtp.hostport}"
			subject="Test build #${build.number}" from="${smtp.from}" tolist="${smtp.tolist}">
			<message>The build #${build.number} is now available for testing.
			</message>
		</mail>
	</target>
</project>