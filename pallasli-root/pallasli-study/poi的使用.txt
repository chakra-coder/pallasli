//写文件
FileOutputStream fileout=new FileOutputStream(“workbook.xsl”);//创建输出文件流
HSSFWorkbook wb = new HSSFWorkbook();//建立excel对象
HSSFSheet sheet =wb.createSheet(“new sheet”);//创建sheet
HSSFRow row = sheet.createRow((short)0);//创建行,从0行开始
HSSFCell cell = row.createCell((short)0); //创建单元格,从0开始
HSSFCellStyle style = wb.createCellStyle();//创建单元格样式
HSSFFont font = wb.createFont();//创建字体
font.setColor(HSSFFont.COLOR_RED);
font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
style.setFont(font);//设置单元格样式——字体
style.setDataFormat(HSSFDataFormat.getFormat(“m/d/yy h:mm”));//设置单元格样式——格式
--style.setDataFormat(HSSFDataFormat.getBuiltinFormat(“m/d/yy h:mm”));//设置单元格样式——格式style.setFillBackgroundColor(HSSFCellStyle.AQUA);// 设置单元格样式——填充背景色style.setFillBackgroundColor(HSSFCellStyle.GREEN.index);// 设置单元格样式——填充背景色style.setFillForegroundColor(HSSFCellStyle.RED.index);// 设置单元格样式——显示色
style.setFillPattern(HSSFCellStyle.BIG_SPORT);// 设置单元格样式——填充类型
style.setAlignment(HSSFCellStyle.ALIGN_CENTER);// 设置单元格样式——对齐方式
style.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);// 设置单元格样式——对齐方式
cell.setEncoding(HSSFCell.ENCODING_UTF_16);//设置编码格式解决中文乱码
cell.setCellType(HSSFCell.CELL_TYPE_STRING);//设置单元格字符类型
cell.setCellValue(new Date());//设置单元格的值
cell.setCellStyle(style);//设置单元格样式
row.createCell((short)1).setCellType(HSSFCell.CELL_TYPE_ERROR);//建立错误单元格
wb.write(fileout);//输出文件
fileout.flush();//刷新缓存
fileout.close();//关闭流

wb.setSheetName(index,name);//设置工作表名称
wb.setSelectTab(index);//选择工作表
wb.setSheetHidden(index,boolean);//隐藏或显示
row.createCell(index,type);//创建某种格式单元格
sheet.addMergedRegion( new Region(int rowf,short colf,int rowt,short colt));//合并单元格

FileInputStream fs=new (imagePath);
byte[] bytes=new byte[fs.available()];
fs.read(bytes);
int picIndex=wb.addPicture(bytes,wb.PICTURE_TYPE_JPEG);//添加字节数据到工作簿
HSSFClientAnchor anchor= new HSSFClientAnchor ();
anchor.setAnchor(col1,row1,x1,y1,col2,row2,x2,y2);//指定区域
HSSFPatriarch patri=sheet.createDrawingPatriarch();//绘画对象
patri.createPictrue(anchor,picIndex);//绘制


//读文件
HSSFWorkbook wb = new HSSFWorkbook(new FileInputStream(“路径”));//读取excel文件流
HSSFSheet sheet =wb.getSheet(“new sheet”);// 读取sheet 
//HSSFSheet sheet =wb.getSheetAt(0);//读取sheet从0开始
HSSFRow row = sheet.getRow(0);//读取行,从0行开始
HSSFCell cell = row.getCell((short)0); //读取单元格,从0开始
cell.getStringCellValue()//读取单元格的值

//下载文件
response.setContentType(“application/ms-excel”);
response.setContentType(“application/ms-excel;charset=gb2312”);
response.setContentType(“application/msword;charset=gb2312”); 
response.setHeader(“Content-Disposition”,”inline;filename=***.xls”)); 
response.setHeader(“Content-Disposition”,”attachment;filename=”+
new String(“文件名”.getBytes(),”iso-8859-1”));//attachment 提示保存或者打开
wb.write(response.getOutputStream());
//poi缺陷
反复读写一个excel文件，读的速度会越来越慢
不支持图片
打开的sheet页执行sheet.setRowBreak 当sheet里原本没有分页符时会抛出异常
